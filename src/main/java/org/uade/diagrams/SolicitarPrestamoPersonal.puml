@startuml
actor Cliente
participant "PrestamoController" as PC
participant "ClienteController" as CC
participant "Cliente" as C
participant "CajaAhorro" as CA
participant "Prestamo: PrestamoPersonal" as P
participant "Operacion" as O

Cliente -> PC: solicitarPrestamoPersonal(SolicitarPrestamoDTO p): int
activate PC

PC -> CC: getCliente(int dni): Cliente
activate CC

loop Por cada cliente
    CC -> C: getDni(): int
    activate C
    opt dni coincide
        CC <-- C: cliente
    end
    deactivate C
end

CC --> PC: cliente encontrado
deactivate CC

opt cuotas => 12 && <= 24
    PC -> C: getCaja(): CajaAhorro
    activate C
    C --> PC: caja de ahorro encontrada
    deactivate C

    PC -> P: crear Prestamo Personal (double monto, int plazo, double tasa, Cliente cliente)
    activate P
    PC <-- P: prestamo Personal creado
    deactivate P

    PC -> CA: agregarSaldo(float saldo)
    activate CA
    CA --> PC: true
    deactivate CA
end
PC -> O: crearOperacion(Date fecha, TipoOperacion tipo, float monto)
activate O
O --> PC: Operacion registrada
deactivate O

PC -> CA : registrarOperacionCajaAhorro(Operacion operacion)
activate CA
CA --> PC: Operacion registrada en CajaAhorro
deactivate CA


PC --> Cliente: Prestamo confirmado
@enduml